<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToolHub - AI Tool Directory</title>
    <meta name="description" content="Discover the best AI tools, productivity apps, and creative software all in one place. Search through 500+ tools across 50+ categories.">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #4f46e5;
            --primary-dark: #3730a3;
            --secondary: #6b7280;
            --background: #ffffff;
            --background-alt: #f9fafb;
            --surface: #ffffff;
            --text: #111827;
            --text-light: #6b7280;
            --border: #e5e7eb;
            --border-light: #f3f4f6;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --radius: 0.5rem;
        }

        .dark {
            --background: #0f172a;
            --background-alt: #1e293b;
            --surface: #1e293b;
            --text: #f8fafc;
            --text-light: #94a3b8;
            --border: #334155;
            --border-light: #475569;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.3), 0 1px 2px -1px rgb(0 0 0 / 0.3);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3), 0 4px 6px -4px rgb(0 0 0 / 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-alt);
            color: var(--text);
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Header */
        .header {
            position: sticky;
            top: 0;
            z-index: 50;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .dark .header {
            background: rgba(15, 23, 42, 0.8);
        }

        .header-content {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 64px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .search-container {
            flex: 1;
            max-width: 32rem;
            margin: 0 2rem;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 2rem;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        .nav-buttons {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-light);
        }

        .btn-ghost:hover {
            background: var(--background-alt);
            color: var(--text);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .favorites-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: var(--error);
            color: white;
            font-size: 0.75rem;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #f0f9ff, #e0e7ff);
            padding: 4rem 1rem;
            text-align: center;
        }

        .dark .hero {
            background: linear-gradient(135deg, #1e293b, #0f172a);
        }

        .hero-content {
            max-width: 1280px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.25rem;
            color: var(--text-light);
            margin-bottom: 2rem;
            max-width: 48rem;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-light);
        }

        .stat i {
            color: var(--success);
        }

        /* Main Content */
        .main-content {
            max-width: 1280px;
            margin: 0 auto;
            padding: 2rem 1rem;
            display: flex;
            gap: 2rem;
        }

        /* Sidebar */
        .sidebar {
            width: 256px;
            position: sticky;
            top: 96px;
            height: fit-content;
        }

        .category-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .category-card h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .category-list {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .category-btn {
            width: 100%;
            padding: 0.5rem 0.75rem;
            background: transparent;
            border: none;
            border-radius: var(--radius);
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text);
        }

        .category-btn:hover {
            background: var(--background-alt);
        }

        .category-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Content Area */
        .content {
            flex: 1;
        }

        .content-header {
            margin-bottom: 1.5rem;
        }

        .content-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .content-subtitle {
            color: var(--text-light);
        }

        /* Mobile Category Filter */
        .mobile-categories {
            display: none;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .mobile-category-list {
            display: flex;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .mobile-category-btn {
            padding: 0.5rem 1rem;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 2rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .mobile-category-btn:hover {
            background: var(--background-alt);
        }

        .mobile-category-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Tools Grid */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .tool-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .tool-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .tool-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .tool-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
        }

        .favorite-btn {
            background: transparent;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--radius);
            transition: all 0.2s ease;
        }

        .favorite-btn:hover {
            color: var(--error);
        }

        .favorite-btn.active {
            color: var(--error);
        }

        .tool-badge {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            margin-bottom: 0.75rem;
            display: inline-block;
        }

        .tool-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            transition: color 0.2s ease;
        }

        .tool-card:hover .tool-title {
            color: var(--primary);
        }

        .tool-description {
            color: var(--text-light);
            font-size: 0.875rem;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .tool-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .rating {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .star {
            color: #fbbf24;
            font-size: 0.75rem;
        }

        .star.empty {
            color: var(--border);
        }

        .rating-text {
            font-size: 0.875rem;
            color: var(--text-light);
            margin-left: 0.25rem;
        }

        .upvote-btn {
            background: transparent;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .upvote-btn:hover {
            color: var(--primary);
            background: rgba(79, 70, 229, 0.1);
        }

        .upvote-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .tool-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            margin-bottom: 1rem;
        }

        .tag {
            background: var(--background-alt);
            color: var(--text-light);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
        }

        .tool-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-visit {
            flex: 1;
            background: var(--primary);
            color: white;
            text-decoration: none;
            text-align: center;
        }

        .btn-visit:hover {
            background: var(--primary-dark);
            color: white;
        }

        .report-btn {
            background: transparent;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--radius);
            transition: all 0.2s ease;
        }

        .report-btn:hover {
            color: var(--text);
            background: var(--background-alt);
        }

        /* Loading State */
        .loading {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .skeleton {
            background: var(--border-light);
            border-radius: var(--radius);
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .skeleton-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
        }

        .skeleton-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .skeleton-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius);
        }

        .skeleton-favorite {
            width: 32px;
            height: 32px;
            border-radius: var(--radius);
        }

        .skeleton-title {
            height: 24px;
            width: 75%;
            margin-bottom: 0.5rem;
        }

        .skeleton-description {
            height: 16px;
            width: 100%;
            margin-bottom: 0.25rem;
        }

        .skeleton-tags {
            display: flex;
            gap: 0.25rem;
            margin-bottom: 1rem;
        }

        .skeleton-tag {
            height: 24px;
            width: 64px;
            border-radius: 0.25rem;
        }

        .skeleton-button {
            height: 40px;
            width: 100%;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
        }

        .empty-icon {
            font-size: 4rem;
            color: var(--border);
            margin-bottom: 1rem;
        }

        .empty-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .empty-subtitle {
            color: var(--text-light);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            padding: 1rem;
        }

        .modal {
            background: var(--surface);
            border-radius: var(--radius);
            max-width: 32rem;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            padding: 1.5rem 1.5rem 0;
            display: flex;
            align-items: center;
            justify-content: between;
            gap: 0.5rem;
        }

        .modal-title {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .modal-content {
            padding: 1.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.75rem;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-actions {
            display: flex;
            gap: 0.75rem;
            padding-top: 1rem;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text);
        }

        .btn-outline:hover {
            background: var(--background-alt);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1rem;
            box-shadow: var(--shadow-lg);
            z-index: 200;
            animation: slideIn 0.3s ease;
            max-width: 400px;
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--error);
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .toast-description {
            color: var(--text-light);
            font-size: 0.875rem;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                display: none;
            }

            .mobile-categories {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .hero-stats {
                gap: 1rem;
            }

            .search-container {
                margin: 0 1rem;
            }

            .nav-buttons {
                gap: 0.25rem;
            }

            .btn {
                padding: 0.5rem;
            }

            .btn-text {
                display: none;
            }

            .main-content {
                padding: 1rem;
                gap: 1rem;
            }

            .tools-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .header-content {
                padding: 0 0.5rem;
            }

            .hero {
                padding: 2rem 0.5rem;
            }

            .main-content {
                padding: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <span>ToolHub</span>
            </div>

            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="searchInput" class="search-input" 
                       placeholder="Search AI tools, PDF tools, image editors...">
            </div>

            <div class="nav-buttons">
                <button id="favoritesBtn" class="btn btn-ghost" style="position: relative;">
                    <i class="fas fa-heart"></i>
                    <span class="btn-text">Favorites</span>
                    <span id="favoritesBadge" class="favorites-badge" style="display: none;">0</span>
                </button>
                
                <button id="themeBtn" class="btn btn-ghost">
                    <i class="fas fa-moon"></i>
                </button>
                
                <button id="addToolBtn" class="btn btn-primary">
                    <i class="fas fa-plus"></i>
                    <span class="btn-text">Add Tool</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>
                Discover the Best <span class="gradient-text">AI Tools</span>
            </h1>
            <p>
                Find, compare, and access the most powerful AI tools, productivity apps, and creative software all in one place.
            </p>
            <div class="hero-stats">
                <div class="stat">
                    <i class="fas fa-check-circle"></i>
                    <span>500+ Tools</span>
                </div>
                <div class="stat">
                    <i class="fas fa-check-circle"></i>
                    <span>50+ Categories</span>
                </div>
                <div class="stat">
                    <i class="fas fa-check-circle"></i>
                    <span>Free to Use</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="category-card">
                <h3>Categories</h3>
                <div id="categoryList" class="category-list">
                    <!-- Categories will be loaded here -->
                </div>
            </div>
        </aside>

        <!-- Content -->
        <main class="content">
            <!-- Mobile Categories -->
            <div class="mobile-categories">
                <div id="mobileCategoryList" class="mobile-category-list">
                    <!-- Mobile categories will be loaded here -->
                </div>
            </div>

            <!-- Content Header -->
            <div class="content-header">
                <h2 id="contentTitle">Featured Tools</h2>
                <p id="contentSubtitle" class="content-subtitle">
                    Discover the most popular AI tools and utilities
                </p>
            </div>

            <!-- Tools Grid -->
            <div id="toolsGrid" class="tools-grid">
                <!-- Tools will be loaded here -->
            </div>
        </main>
    </div>

    <!-- Add Tool Modal -->
    <div id="addToolModal" class="modal-overlay" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <i class="fas fa-plus"></i>
                <h3 class="modal-title">Add New Tool</h3>
            </div>
            <div class="modal-content">
                <form id="addToolForm">
                    <div class="form-group">
                        <label class="form-label">Tool Name</label>
                        <input type="text" name="name" class="form-input" placeholder="Enter tool name" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea name="description" class="form-textarea" 
                                  placeholder="Describe what this tool does" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select name="category" class="form-select" required>
                            <option value="">Select a category</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Website URL</label>
                        <input type="url" name="url" class="form-input" 
                               placeholder="https://example.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Tags (comma separated)</label>
                        <input type="text" name="tags" class="form-input" 
                               placeholder="ai, writing, productivity">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Icon (FontAwesome class)</label>
                        <input type="text" name="icon" class="form-input" 
                               placeholder="fas fa-cog" value="fas fa-cog">
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary" style="flex: 1;">
                            Add Tool
                        </button>
                        <button type="button" id="cancelAddTool" class="btn btn-outline" style="flex: 1;">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Favorites Modal -->
    <div id="favoritesModal" class="modal-overlay" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <i class="fas fa-heart" style="color: var(--error);"></i>
                <h3 class="modal-title">Favorite Tools (<span id="favoritesCount">0</span>)</h3>
            </div>
            <div class="modal-content">
                <div id="favoritesList">
                    <!-- Favorites will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let tools = [];
        let categories = [];
        let favorites = JSON.parse(localStorage.getItem('toolhub-favorites') || '[]');
        let upvotedTools = JSON.parse(localStorage.getItem('toolhub-upvoted') || '[]');
        let currentCategory = 'all';
        let currentSearch = '';
        let isDark = localStorage.getItem('toolhub-theme') === 'dark';

        // API functions
        async function fetchTools(category = '', search = '') {
            const params = new URLSearchParams();
            if (category && category !== 'all') params.set('category', category);
            if (search) params.set('search', search);
            
            const response = await fetch(`/api/tools?${params}`);
            return response.json();
        }

        async function fetchCategories() {
            const response = await fetch('/api/categories');
            return response.json();
        }

        async function createTool(toolData) {
            const response = await fetch('/api/tools', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(toolData)
            });
            return response.json();
        }

        async function upvoteTool(toolId) {
            const response = await fetch(`/api/tools/${toolId}/upvote`, {
                method: 'POST'
            });
            return response.json();
        }

        // Utility functions
        function showToast(title, description, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-title">${title}</div>
                <div class="toast-description">${description}</div>
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        function updateFavorites() {
            localStorage.setItem('toolhub-favorites', JSON.stringify(favorites));
            updateFavoritesBadge();
        }

        function updateFavoritesBadge() {
            const badge = document.getElementById('favoritesBadge');
            if (favorites.length > 0) {
                badge.textContent = favorites.length;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        function toggleFavorite(toolId) {
            const index = favorites.indexOf(toolId);
            if (index === -1) {
                favorites.push(toolId);
                showToast('Added to favorites', 'Tool has been added to your favorites.');
            } else {
                favorites.splice(index, 1);
                showToast('Removed from favorites', 'Tool has been removed from your favorites.');
            }
            updateFavorites();
            renderTools();
        }

        function toggleTheme() {
            isDark = !isDark;
            document.body.classList.toggle('dark', isDark);
            localStorage.setItem('toolhub-theme', isDark ? 'dark' : 'light');
            
            const themeBtn = document.getElementById('themeBtn');
            themeBtn.innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
        }

        function createStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                stars += `<i class="fas fa-star star ${i <= rating ? '' : 'empty'}"></i>`;
            }
            return stars;
        }

        function formatCategory(category) {
            return category.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
        }

        // Render functions
        function renderCategories() {
            const categoryList = document.getElementById('categoryList');
            const mobileCategoryList = document.getElementById('mobileCategoryList');
            
            let html = '';
            let mobileHtml = '';
            
            categories.forEach(category => {
                const isActive = currentCategory === category.id;
                
                html += `
                    <button class="category-btn ${isActive ? 'active' : ''}" 
                            onclick="selectCategory('${category.id}')">
                        <i class="${category.icon}"></i>
                        ${category.name}
                    </button>
                `;
                
                mobileHtml += `
                    <button class="mobile-category-btn ${isActive ? 'active' : ''}" 
                            onclick="selectCategory('${category.id}')">
                        ${category.name}
                    </button>
                `;
            });
            
            categoryList.innerHTML = html;
            mobileCategoryList.innerHTML = mobileHtml;
            
            // Populate category select in modal
            const categorySelect = document.querySelector('select[name="category"]');
            categorySelect.innerHTML = '<option value="">Select a category</option>' +
                categories.filter(cat => cat.id !== 'all').map(cat => 
                    `<option value="${cat.id}">${cat.name}</option>`
                ).join('');
        }

        function renderTools() {
            const grid = document.getElementById('toolsGrid');
            
            if (tools.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 class="empty-title">No tools found</h3>
                        <p class="empty-subtitle">Try adjusting your search or filters to find more tools.</p>
                    </div>
                `;
                return;
            }
            
            const html = tools.map(tool => {
                const isFavorite = favorites.includes(tool.id);
                const hasUpvoted = upvotedTools.includes(tool.id);
                
                return `
                    <div class="tool-card">
                        <div class="tool-header">
                            <div class="tool-icon">
                                <i class="${tool.icon}"></i>
                            </div>
                            <button class="favorite-btn ${isFavorite ? 'active' : ''}" 
                                    onclick="toggleFavorite(${tool.id})">
                                <i class="fas fa-heart"></i>
                            </button>
                        </div>
                        
                        ${tool.featured ? '<span class="tool-badge">Featured</span>' : ''}
                        
                        <h3 class="tool-title">${tool.name}</h3>
                        <p class="tool-description">${tool.description}</p>
                        
                        <div class="tool-meta">
                            <div class="rating">
                                ${createStars(tool.rating)}
                                <span class="rating-text">${tool.rating.toFixed(1)}</span>
                            </div>
                            <button class="upvote-btn" onclick="handleUpvote(${tool.id})" 
                                    ${hasUpvoted ? 'disabled' : ''}>
                                <i class="fas fa-arrow-up"></i>
                                <span>${tool.upvotes + (hasUpvoted ? 1 : 0)}</span>
                            </button>
                        </div>
                        
                        <div class="tool-tags">
                            ${tool.tags.slice(0, 3).map(tag => 
                                `<span class="tag">${tag}</span>`
                            ).join('')}
                        </div>
                        
                        <div class="tool-actions">
                            <a href="${tool.url}" target="_blank" rel="noopener noreferrer" 
                               class="btn btn-visit">
                                Visit Tool
                                <i class="fas fa-external-link-alt"></i>
                            </a>
                            <button class="report-btn" onclick="reportTool('${tool.name}')">
                                <i class="fas fa-flag"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            grid.innerHTML = html;
        }

        function renderLoading() {
            const grid = document.getElementById('toolsGrid');
            let html = '';
            
            for (let i = 0; i < 9; i++) {
                html += `
                    <div class="skeleton-card">
                        <div class="skeleton-header">
                            <div class="skeleton skeleton-icon"></div>
                            <div class="skeleton skeleton-favorite"></div>
                        </div>
                        <div class="skeleton skeleton-title"></div>
                        <div class="skeleton skeleton-description"></div>
                        <div class="skeleton skeleton-description" style="width: 66%;"></div>
                        <div class="skeleton-tags">
                            <div class="skeleton skeleton-tag"></div>
                            <div class="skeleton skeleton-tag"></div>
                        </div>
                        <div class="skeleton skeleton-button"></div>
                    </div>
                `;
            }
            
            grid.innerHTML = html;
        }

        function renderFavorites() {
            const favoritesList = document.getElementById('favoritesList');
            const favoritesCount = document.getElementById('favoritesCount');
            
            favoritesCount.textContent = favorites.length;
            
            if (favorites.length === 0) {
                favoritesList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h3 class="empty-title">No favorite tools yet</h3>
                        <p class="empty-subtitle">Start exploring and save your favorite tools!</p>
                    </div>
                `;
                return;
            }
            
            const favoriteTools = tools.filter(tool => favorites.includes(tool.id));
            
            const html = favoriteTools.map(tool => `
                <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; border: 1px solid var(--border); border-radius: var(--radius); margin-bottom: 0.5rem;">
                    <div class="tool-icon" style="width: 48px; height: 48px;">
                        <i class="${tool.icon}"></i>
                    </div>
                    <div style="flex: 1; min-width: 0;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                            <h4 style="font-weight: 600; margin: 0;">${tool.name}</h4>
                            ${tool.featured ? '<span class="tool-badge">Featured</span>' : ''}
                        </div>
                        <p style="color: var(--text-light); font-size: 0.875rem; margin: 0; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;">${tool.description}</p>
                        <div style="display: flex; gap: 0.25rem; margin-top: 0.5rem;">
                            ${tool.tags.slice(0, 3).map(tag => 
                                `<span class="tag">${tag}</span>`
                            ).join('')}
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <button class="btn btn-ghost" onclick="toggleFavorite(${tool.id}); renderFavorites();" 
                                style="color: var(--error); padding: 0.5rem;">
                            <i class="fas fa-times"></i>
                        </button>
                        <a href="${tool.url}" target="_blank" rel="noopener noreferrer" 
                           class="btn btn-primary" style="padding: 0.5rem 1rem;">
                            Visit
                            <i class="fas fa-external-link-alt"></i>
                        </a>
                    </div>
                </div>
            `).join('');
            
            favoritesList.innerHTML = html;
        }

        function updateContentHeader() {
            const title = document.getElementById('contentTitle');
            const subtitle = document.getElementById('contentSubtitle');
            
            if (currentSearch) {
                title.textContent = `Search results for "${currentSearch}"`;
                subtitle.textContent = `Found ${tools.length} tools`;
            } else if (currentCategory === 'all') {
                title.textContent = 'Featured Tools';
                subtitle.textContent = 'Discover the most popular AI tools and utilities';
            } else {
                title.textContent = `${formatCategory(currentCategory)} Tools`;
                subtitle.textContent = `Explore ${formatCategory(currentCategory).toLowerCase()} tools and utilities`;
            }
        }

        // Event handlers
        async function loadTools() {
            renderLoading();
            try {
                tools = await fetchTools(currentCategory, currentSearch);
                renderTools();
                updateContentHeader();
            } catch (error) {
                console.error('Failed to load tools:', error);
                showToast('Error', 'Failed to load tools. Please try again.', 'error');
            }
        }

        async function selectCategory(categoryId) {
            currentCategory = categoryId;
            currentSearch = '';
            document.getElementById('searchInput').value = '';
            renderCategories();
            await loadTools();
        }

        async function handleSearch(query) {
            currentSearch = query;
            await loadTools();
        }

        async function handleUpvote(toolId) {
            if (upvotedTools.includes(toolId)) return;
            
            try {
                await upvoteTool(toolId);
                upvotedTools.push(toolId);
                localStorage.setItem('toolhub-upvoted', JSON.stringify(upvotedTools));
                showToast('Upvoted!', 'Thanks for supporting this tool!');
                await loadTools();
            } catch (error) {
                console.error('Failed to upvote tool:', error);
                showToast('Error', 'Failed to upvote tool. Please try again.', 'error');
            }
        }

        function reportTool(toolName) {
            showToast('Report submitted', `Thank you for reporting ${toolName}. We'll review it shortly.`);
        }

        // Modal functions
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
            if (modalId === 'favoritesModal') {
                renderFavorites();
            }
        }

        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Initialize app
        async function init() {
            // Set initial theme
            document.body.classList.toggle('dark', isDark);
            document.getElementById('themeBtn').innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
            
            // Load data
            categories = await fetchCategories();
            renderCategories();
            updateFavoritesBadge();
            await loadTools();
            
            // Event listeners
            document.getElementById('searchInput').addEventListener('input', (e) => {
                const query = e.target.value.trim();
                clearTimeout(window.searchTimeout);
                window.searchTimeout = setTimeout(() => handleSearch(query), 300);
            });
            
            document.getElementById('themeBtn').addEventListener('click', toggleTheme);
            
            document.getElementById('favoritesBtn').addEventListener('click', () => {
                showModal('favoritesModal');
            });
            
            document.getElementById('addToolBtn').addEventListener('click', () => {
                showModal('addToolModal');
            });
            
            document.getElementById('cancelAddTool').addEventListener('click', () => {
                hideModal('addToolModal');
            });
            
            document.getElementById('addToolForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const toolData = {
                    name: formData.get('name'),
                    description: formData.get('description'),
                    category: formData.get('category'),
                    url: formData.get('url'),
                    tags: formData.get('tags').split(',').map(tag => tag.trim()).filter(Boolean),
                    icon: formData.get('icon') || 'fas fa-cog'
                };
                
                try {
                    await createTool(toolData);
                    showToast('Tool added successfully!', `${toolData.name} has been added to the directory.`);
                    hideModal('addToolModal');
                    e.target.reset();
                    await loadTools();
                } catch (error) {
                    console.error('Failed to create tool:', error);
                    showToast('Error', 'Failed to add tool. Please try again.', 'error');
                }
            });
            
            // Close modals when clicking overlay
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal-overlay')) {
                    e.target.style.display = 'none';
                }
            });
        }

        // Start the app
        init();
    </script>
</body>
</html>
